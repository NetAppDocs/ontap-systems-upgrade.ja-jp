---
permalink: upgrade/upgrade-remove-original-nodes.html 
sidebar: sidebar 
keywords: volume, move, node, remove, original, cluster, configuration, disk, initialize, remove the original nodes from the cluster 
summary: ボリュームが新しいノードに移動されたら、元のノードをクラスターから削除します。ノードを削除すると、ノードの構成が消去され、すべてのディスクが初期化されます。 
---
= 元のノードをクラスターから削除する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ボリュームを元のノードから新しいノードに移動し、データ LIF を移動または削除した後、元のノードをクラスターから削除します。ノードを削除すると、ノードの構成が消去され、すべてのディスクが初期化されます。

.手順
. [[disable-ha]]元のノードの高可用性（HA）構成を無効にします。
+
`storage failover modify -node <original_node_name> -enabled false`

. advanced 権限レベルに切り替えます。
+
「 advanced 」の権限が必要です

. イプシロンが設定されたノードを特定します。
+
「 cluster show 」を参照してください

+
次の例では、「 node0 」に現在イプシロンが設定されています。

+
[listing]
----
cluster::*>
Node                 Health  Eligibility  Epsilon
-------------------- ------- ------------ ------------
node0                true    true         true
node1                true    true         false
node2                true    true         false
node3                true    true         false
----
. [[epsilon-true]]元のノードの 1 つが epsilon を保持している場合は、クラスターから削除しないノードに epsilon を移動します。
+
.. 元のノードからイプシロンを削除します。
+
`cluster modify -node <original_node_name> -epsilon false`

.. イプシロンを別のノードに割り当てます。
+
`cluster modify -node <new_node_name> -epsilon true`



. 現在のマスター ノードを特定します。
+
`cluster ring show`

+
マスターノードは、次のようなプロセスを保持するノードです。 `mgmt`、 `vldb`、 `vifmgr`、 `bcomd`、 そして `crs`。

. 削除するノードが現在のマスター ノードである場合は、クラスター内に残っているノードをマスター ノードとして選択できるようにします。
+
.. 現在のマスター ノードをクラスターに参加できないようにします。
+
`cluster modify -node <original_node_name> -eligibility false`

+
適格性が回復されるまで、ノードは異常としてマークされます。マスター ノードが参加できなくなると、クラスタ クォーラムによって残りのノードの1つが新しいマスターとして選出されます。

+
[NOTE]
====
HA ペアの最初のノードでこの手順を実行する場合は、そのノードのみを不適格としてマークする必要があります。HA パートナーのステータスを変更しないでください。

パートナー ノードが新しいマスターとして選択された場合は、イプシロンを保持しているかどうかを確認する必要があります。パートナー ノードがイプシロンを保持している場合は、イプシロンを無効にする前に、クラスター内に残っている別のノードにイプシロンを移動する必要があります。これらの手順を繰り返してパートナー ノードを削除するときにこれを実行します。

====
.. 以前のマスター ノードを再びクラスタに参加できるようにします。
+
`cluster modify -node <node_name> -eligibility true`



. クラスタ内に残っているノードのリモート ノード管理 LIF またはクラスタ管理 LIF にログインし、元の各ノードをクラスタから削除します (高度な権限レベル)。
+
ノード名付き:

+
[source, cli]
----
cluster remove-node -node <original_node_name>
----
+
ノード IP の場合:

+
[source, cli]
----
cluster remove-node -cluster_ip <original_node_ip>
----
+
混合バージョンのクラスタがあり、最後の下位バージョンのノードを削除する場合は、 `-skip-last-low-version-node-check` これらのコマンドにパラメータを指定します。

+
次の内容のメッセージが表示されます。

+
** ノードのフェイルオーバー パートナーをクラスタから削除する必要があること。
** ノードを削除した後、クラスターに再度参加させる前に、ブート メニュー オプション *(4) 構成を消去してすべてのディスクを初期化する* またはオプション *(9) 高度なドライブ パーティションの構成* を使用して、ノードの構成を消去し、すべてのディスクを初期化する必要があります。
+
ノードを削除する前に対処が必要な条件がある場合は、エラー メッセージが表示されます。メッセージの内容は、たとえば、ノードに削除が必要な共有リソースがある、あるいはノードのクラスタHA構成またはストレージ フェイルオーバー構成を無効にする必要があるなどの場合があります。

+
ノードがクォーラム マスターの場合、クラスタのクォーラムがいったん失われて、すぐに戻ります。クォーラムが失われるのは一時的であり、データの操作には影響しません。



. 失敗メッセージがエラー状態を示している場合は、それらの状態に対処して再度実行してください。 `cluster remove-node` または `cluster unjoin` 指示。
+
ノードがクラスターから正常に削除されると、自動的に再起動します。

. ノードを転用する場合は、ノードの設定を消去し、すべてのディスクを初期化します。
+
.. ブート プロセス時に、プロンプトに応じてCtrl+Cキーを押してブート メニューを表示します。
.. ブートメニューオプション*(4) 構成をクリーンアップし、すべてのディスクを初期化する*を選択します。


. [[return-admin]]クラスター内の新しいノードの 1 つで管理者権限レベルに戻ります。
+
[source, cli]
----
set -privilege admin
----
. 手順を繰り返す <<disable-ha,1>> に <<return-admin,10>> クラスターからフェールオーバー パートナーを削除します。
. クラスタにノードが 2 つしか残っていない場合は、 2 ノードクラスタのハイアベイラビリティを設定します。
+
cluster ha modify -configured true



.次の手順
link:upgrade-complete-move-volumes.html["ボリューム移動のアップグレードを完了する"]
